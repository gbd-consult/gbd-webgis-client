/// map loader

import ol from 'ol-all';

import config from '../app/config';


function backgroundLayer() {
    let bg = config.str('map.background');

    if (bg === 'osm') {
        return new ol.layer.Tile({
            source: new ol.source.OSM(),
            name: 'OSM',
            type: 'BackgroundLayer',
            opacity: 0.3
        });
    }

    if (bg === 'webatlas.de-grau') {
        return new ol.layer.Tile({
            source: new ol.source.TileWMS({
                name: 'Webatlas',
                title: 'Webatlas',
                type: 'BackgroundLayer',
                url: 'http://sg.geodatenzentrum.de/wms_webatlasde.light_grau',
                params: {
                    LAYERS: 'webatlasde.light_grau',
                    CRS: config.str('map.crs.client')
                }
            })
        });
    }
}

async function load(map) {
    let bg = backgroundLayer();
    if(bg) {
        map.addLayer(new ol.layer.Group({
            name: 'Backgrounds',
            zIndex: 0,
            type: 'BackgroundRoot',
            layers: [bg]
        }));
    }

    return map;

}

export default {load};